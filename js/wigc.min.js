function snap(e,t){for(var n=e.length-1;n>=0&&(e[n]!==t||(e.splice(n,1),!0!==multi));n--);}function trackEvent(e,t,n,o){o?(_paq.push(["trackEvent",e,t,n,o]),console.log("CATEGORY: "+e+", ACTION:"+t+", LABEL:"+n+", VALUE:"+o)):n?(_paq.push(["trackEvent",e,t,n]),console.log("CATEGORY: "+e+", ACTION:"+t+", LABEL:"+n)):(_paq.push(["trackEvent",e,t]),console.log("CATEGORY: "+e+", ACTION:"+t))}var app=new Vue({el:"#app",data:{my:{sidebarVisible:!1,meetoo:"",view:"loading",sessions:[],vendors:[]},loaded:!1,home:{},sessions:[],vendors:[],people:[],unfavorited:[],showMyVendors:!0,showTwitter:!0,instagramFeed:{},error_msg:!1},computed:{mySessions:function(){var e=this;return e.sessions.filter(function(t){if(-1!==e.my.sessions.indexOf(t.url)||-1!==e.unfavorited.indexOf(t.url)||"schedule-item"===t.type)return!0})},myVendors:function(){var e=this;return e.vendors.filter(function(t){if(-1!==e.my.vendors.indexOf(t.url)||-1!==e.unfavorited.indexOf(t.url)||!1===e.showMyVendors)return!0})},instagramLatest:function(){var e=this;if(e.instagramFeed.length>0)return e.instagramFeed.slice(0,3)}},mounted:function(){var e=this;$.ajax({url:"https://circle.red/wigc/",method:"GET",success:function(t){e.home=t.home,e.sessions=t.sessions,e.people=t.people,e.vendors=t.vendors,e.loaded=!0},error:function(t){e.error_msg=t.responseText,e.my.view="error"}}),e.getInstagramFeed(),function(e,t,n){var o,i=e.getElementsByTagName(t)[0],r=/^http:/.test(e.location)?"http":"https";e.getElementById(n)||((o=e.createElement(t)).id=n,o.src=r+"://platform.twitter.com/widgets.js",i.parentNode.insertBefore(o,i))}(document,"script","twitter-wjs");var t=indexedDB.open("WIGCApp",3);t.onerror=function(t){e.indexed="Can't use IndexedDB"},t.onsuccess=function(t){e.db=this.result,e.getFavorites(),e.my.view="sessions"},t.onupgradeneeded=function(e){e.currentTarget.result.createObjectStore("my")},document.addEventListener("deviceready",function(){window.plugins.OneSignal.setLogLevel({logLevel:4,visualLevel:4}),console.log("Device Ready!");window.plugins.OneSignal.startInit("2405a721-a178-45fb-a787-a1bf43a2e74c").handleNotificationOpened(function(e){console.log("notificationOpenedCallback: "+JSON.stringify(e))}).endInit()},!1)},updated:function(){var e=this,t=indexedDB.open("WIGCApp",3);t.onerror=function(t){e.indexed="Can't use IndexedDB"},t.onsuccess=function(t){e.db=this.result,e.updateFavorites()},t.onupgradeneeded=function(e){e.currentTarget.result.createObjectStore("my")},!0===e.showTwitter&&"social"===e.my.view&&e.styleTwitterWidget()},methods:{toggleFavorite:function(e,t){var n=this;t.favorite=!t.favorite,console.log(t.url),t.favorite?(e.push(t.url),console.log(t),trackEvent("Favorite",n.my.view,t.title)):(("my-wigc"===n.my.view||"vendors"===n.my.view&&!0===n.showMyVendors)&&(n.unfavorited.push(t.url),setTimeout(function(){snap(n.unfavorited,t.url)},3e3)),snap(e,t.url))},switchSection:function(e){var t=this;t.my.sidebarVisible=!1,"my-wigc"===t.my.view&&(t.unfavorited=[]),"map"==t.my.view&&onLoad(),t.my.view=e,trackEvent("Screen",t.my.view)},mapClick:function(e){var t=e.street_address+" "+e.city+", "+e.state+" "+e.zip;window.open("https://maps.google.com?q="+t,"Map"),console.log(e)},showMeetoo:function(e){var t=this;t.my.meetoo=e,t.switchSection("meetoo")},getFavorites:function(){var e=this;e.getObjectStore("my","readonly").openCursor().onsuccess=function(t){var n=t.target.result;n&&(e.my=n.value,e.error_msg?e.my.view="error":e.my.view="Home")}},updateFavorites:function(){var e=this,t=e.getObjectStore("my","readwrite");t.count().onsuccess=function(n){if(0===n.target.result)try{t.add(e.my,0)}catch(e){throw e}else t.openCursor().onsuccess=function(t){var n=t.target.result;if(n)try{n.update(e.my)}catch(e){throw e}e.sessions.map(function(t){-1!==e.my.sessions.indexOf(t.url)&&(t.favorite=!0)}),e.vendors.map(function(t){-1!==e.my.vendors.indexOf(t.url)&&(t.favorite=!0)})}}},getObjectStore:function(e,t){return this.db.transaction(e,t).objectStore(e)},isDisabled:function(e){return!e.favorite&&"schedule-item"!==e.type},styleTwitterWidget:function(){var e=document.getElementById("twitter-widget-0").contentDocument,t=document.createElement("link");t.href="http://localhost:8888/wigc-app/css/wigc.css",t.rel="stylesheet",e.head.appendChild(t)},getInstagramFeed:function(){var e=this;$.ajax({url:"https://circle.red/wigc/instagram.php?tag=minneapolis",method:"GET",success:function(t){e.instagramFeed=t.entry_data.TagPage[0].tag.media.nodes},error:function(t){e.error_msg=t.responseText,e.my.view="error"}})},parseUserAgent:function(){var e=navigator.userAgent.toLowerCase();return device="",e.indexOf("android")>-1?device="Android":e.indexOf("iphone")>-1||e.indexOf("ipad")>-1||e.indexOf("ipod")>-1?device="iOS":e.indexOf("windows")>-1?device="Windows":e.indexOf("mac os x")>-1&&(device="OSX"),device}}});
//# sourceMappingURL=wigc.min.js.map